<html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
    
      // Load package from google charts
      google.charts.load('current', {'packages':['corechart']});
      
      // Draw the 2 pie charts
      google.charts.setOnLoadCallback(drawSchoolA);
      google.charts.setOnLoadCallback(drawSchoolB);
      
      //draw School A chart
      function drawSchoolA() {
        
        //set up data
        var low = <%= @percLowIncome1%>*100 ;
        var oth = (1 - <%= @percLowIncome1 %>)*100 ;
        
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Type');
        data.addColumn('number', 'Percentage');
        data.addRows([
          ['Low Income', low],
          ['Other', oth]
        ]);
        
        //create specifications
        var options = {
          title: 'Percentage Low Income vs Attendance vs Grad Rate',
          colors: ['#fe6f5e','#3d0c02'],
          is3D: true,
        };
        
        //create + draw chart a
        if(low != 0 && oth != 0){
          var chart = new google.visualization.PieChart(document.getElementById('schoolA_chart_div'));
          chart.draw(data, options);
        }else{
          var output = document.getElementById('schoolA_chart_div').innerHTML = "DATA DOES NOT EXIST OR UNAVAILABLE";
        }
      }
      
      function drawSchoolB(){
        
	//set up data
        var low = <%= @percLowIncome2%>*100 ;
        var oth = (1 - <%=@percLowIncome2%>)*100;
        
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Type');
        data.addColumn('number', 'percentage');
        data.addRows([
          ['Low Income', low],
          ['Other', oth]
        ]);
        
        //set up chart specifications
        var options = {
          title: 'Percentage Low Income vs Attendance vs Grad Rate',
          colors: ['#3c1e62', '#aa8dc8'],
          is3D: true,
        };
        
        //create and draw chart b
        if(low != 0 && oth != 0){
          var chart = new google.visualization.PieChart(document.getElementById('schoolB_chart_div'));
          chart.draw(data, options);
          
          window.addEventListener('resize', function() {
            chart.draw(data, options);
          }, false);
        }else{
          var output = document.getElementById('schoolA_chart_div').innerHTML = "DATA DOES NOT EXIST OR UNAVAILABLE";
        }
      }
    
    </script>

 </head>
  <body>
    <table style="height:100%;width:100%; position: absolute; top: 0; bottom: 0; left: 0; right: 0;border:1px solid">
      <tr style = "height: 10%;">
        <td><%= @school1 %> <%= @year%> </td>
        <td><%= @school2 %> <%= @year%> </td>
      </tr>
      <tr style = "height: 70%;">
      <td><div id="schoolA_chart_div"></div></td>
      <td><div id="schoolB_chart_div"></div></td>
      </tr>
      <tr style="height: 10%;">
        <td>Avg Attendance Rate Per Student: <%= @attendanceRate1 %></td>
        <td>Avg Attendance Rate Per Student: <%= @attendanceRate2 %></td>
      </tr>
      <tr style = "height: 10%;">
        <td>Grad Rate: <%= @gradRate1 - (@gradRate1 %1) %> </td>
        <td>Grad Rate: <%= @gradRate2 - (@gradRate2 %1) %></td>
      </tr>
    </table>
  </body>
</html>
